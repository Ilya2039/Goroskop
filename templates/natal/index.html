<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>–ù–∞—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      background: black;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    h1 {
      color: white;
      text-align: center;
      margin-bottom: 20px;
    }

    form {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }

    label {
      color: white;
      font-size: 16px;
      text-align: center;
    }

    input {
      padding: 10px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      outline: none;
      width: 200px;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      color: white;
      background-color: #0078d7;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #005bb5;
    }

    .result {
      margin-top: 20px;
      color: white;
      font-size: 16px;
      text-align: center;
      padding: 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
    }

    .result.show {
      opacity: 1;
      transform: translateY(0);
    }
  </style>
</head>
<body>
  <h1>–ù–∞—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞</h1>
  <form id="natalForm">
    <label for="birthDate">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</label>
    <input type="date" id="birthDate" name="birthDate" required />
    
    <label for="birthTime">–í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è:</label>
    <input type="time" id="birthTime" name="birthTime" required />
    
    <label for="birthCity">–ì–æ—Ä–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è:</label>
    <input type="text" id="birthCity" name="birthCity" placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥" required />
    
    <button type="submit">–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∫–∞—Ä—Ç—É</button>
  </form>

  <div class="result" id="result"></div>

  <script>
    const form = document.getElementById('natalForm');
    const resultDiv = document.getElementById('result');

    form.addEventListener('submit', async (event) => {
      event.preventDefault();

      const birthDate = document.getElementById('birthDate').value;
      const birthTime = document.getElementById('birthTime').value;
      const birthCity = document.getElementById('birthCity').value;

      const query = `Make a detailed natal chart analysis for a person born on ${birthDate} at ${birthTime} in ${birthCity}. Provide a structured response with the following sections:

**üåû Sun Sign & Personality:** Describe the person's core traits and life purpose based on their Sun sign.  
**üåô Moon Sign & Emotions:** Explain their emotional nature, inner world, and instincts.  
**‚¨Ü Ascendant (Rising Sign):** Define their outward personality, first impressions, and how they approach life.  
**ü™ê Major Planets:** Provide interpretations for Mercury (mind & communication), Venus (love & relationships), Mars (action & energy), Jupiter (growth & luck), and Saturn (discipline & challenges).  
**üè° House Analysis:** Highlight the most important houses that shape career, relationships, and personal development.  
**üîó Key Aspects:** Explain significant planetary aspects (conjunctions, trines, squares) and their influence.  
**‚ú® Life Themes & Guidance:** Summarize the key themes of their life path and offer advice based on their chart.  

Limit the response to 2000 characters while keeping it insightful, engaging, and easy to read.`;

      try {
        const response = await fetch('https://9d18-79-127-211-218.ngrok-free.app/natal/gemini', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ query })
        });

        const data = await response.json();
        const answer = data.answer || '–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç Gemini.';
        
        // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç –ø–æ—è–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
        resultDiv.textContent = answer;
        resultDiv.classList.add('show');

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ –æ–±—Ä–∞—Ç–Ω–æ –≤ Telegram Web App
        if (window.Telegram.WebApp) {
          window.Telegram.WebApp.sendData(JSON.stringify({ natal_chart: answer }));
        }
      } catch (error) {
        resultDiv.textContent = '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + error.message;
        resultDiv.classList.add('show');
      }
    });
  </script>
</body>
</html>
